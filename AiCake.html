<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Cake-Bot ‚Ä¢ DeepAI demo</title>
<meta name="viewport" content="width=device-width,initial-scale=1">
<style>
  *{box-sizing:border-box;margin:0;padding:0}
  body{display:flex;height:100vh;font-family:Arial,Helvetica,sans-serif;background:#f5f5f5}
  /* ‚îÄ‚îÄ sidebar ‚îÄ‚îÄ */
  .side{width:220px;background:#222;color:#eee;padding:20px;display:flex;flex-direction:column}
  .side h2{margin-bottom:20px;font-size:1.3rem}
  .side button{padding:10px;border:none;border-radius:8px;background:#333;color:#eee;cursor:pointer;text-align:left;margin-bottom:12px}
  .side button.active{background:#4caf50}
  /* ‚îÄ‚îÄ main panel ‚îÄ‚îÄ */
  .main{flex:1;display:flex;flex-direction:column}
  .chat{flex:1;overflow-y:auto;padding:20px;display:flex;flex-direction:column;gap:16px}
  .msg{max-width:75%;padding:10px 14px;border-radius:14px;background:#e1e1e1;align-self:flex-end;white-space:pre-line}
  .ai{background:#d4ffdf;align-self:flex-start}
  .msg img{max-width:100%;border-radius:10px;margin-top:6px}
  .promptBar{display:flex;padding:14px;gap:10px;background:#fff;border-top:1px solid #ccc}
  textarea{flex:1;padding:10px;font-size:16px;border-radius:12px;border:1px solid #ccc;resize:none}
  .promptBar button{padding:0 22px;border:none;border-radius:12px;background:#4caf50;color:#fff;font-size:16px;cursor:pointer}
  .promptBar button:hover{background:#45a049}
</style>
</head>
<body>

<!-- ‚îÄ‚îÄ sidebar ‚îÄ‚îÄ -->
<aside class="side">
  <h2>Menu</h2>
  <button id="aiBtn" class="active" onclick="switchTab('ai')">ü§ñ AI</button>
  <button id="galBtn" onclick="switchTab('gallery')">üñºÔ∏è Gallery</button>
</aside>

<!-- ‚îÄ‚îÄ main panel ‚îÄ‚îÄ -->
<section class="main">
  <div id="chat" class="chat"></div>

  <div class="promptBar">
    <textarea id="promptInput" rows="2" placeholder="Describe your cake..."></textarea>
    <button onclick="sendPrompt()">Send</button>
  </div>
</section>

<script>
const API_KEY = "74ad50f7-9c3e-44bc-a53c-0cd871641f12";   // ‚Üê replace any time
const ENDPOINT = "https://api.deepai.org/api/stable-diffusion";

const chatBox = document.getElementById('chat');
const promptInput = document.getElementById('promptInput');
const galleryBtn = document.getElementById('galBtn');
const aiBtn = document.getElementById('aiBtn');

let galleryHTML = "";   // will store generated image bubbles

function switchTab(tab){
  aiBtn.classList.toggle('active', tab==='ai');
  galleryBtn.classList.toggle('active', tab==='gallery');
  chatBox.innerHTML = (tab==='gallery') ? galleryHTML || "No images yet." : "";
}

async function sendPrompt(){
  const prompt = promptInput.value.trim();
  if(!prompt) return;
  promptInput.value = "";

  appendMsg(prompt,false);               // user bubble
  const thinking = appendMsg("‚Ä¶thinking ü§î",true);   // placeholder AI bubble

  try{
    const fd = new FormData();
    fd.append("text", prompt);

    const res = await fetch(ENDPOINT,{
      method:"POST",
      headers:{ "api-key": API_KEY },
      body: fd
    });
    const data = await res.json();

    if(res.ok && data.output_url){
      thinking.innerHTML =
        `<img src="${data.output_url}" alt="AI image">
         \nHere are some ideas you could try next:\n‚Ä¢ ‚ÄúRainbow drip cake with sprinkles‚Äù\n‚Ä¢ ‚ÄúMinimalist black-and-white wedding cake‚Äù\n‚Ä¢ ‚ÄúGalaxy mirror-glaze mousse cake‚Äù`;
      galleryHTML = thinking.outerHTML + galleryHTML;  // save to gallery
    } else {
      thinking.textContent = "‚ùå  Failed: " + (data?.status || "unknown error");
    }
  }catch(err){
    thinking.textContent = "‚ùå  Network error";
    console.error(err);
  }
  chatBox.scrollTop = chatBox.scrollHeight;
}

function appendMsg(txt,isAI){
  const div=document.createElement('div');
  div.className='msg'+(isAI?' ai':'');
  div.textContent=txt;
  chatBox.appendChild(div);
  chatBox.scrollTop = chatBox.scrollHeight;
  return div;
}
</script>
</body>
</html>
